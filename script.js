const translations = {
    ru: {
        title: "Химчистка и дезинфекция в Феодосии",
        about: "О нас",
        services: "Услуги",
        reviews: "Отзывы",
        contacts: "Контакты",
        welcomeTitle: "Химчистка и дезинфекция в Феодосии",
        welcomeText: "Срочный вызов на дом, офис, квартиру:",
        freeConsultation: "Бесплатная консультация",
        acceptRequests: "Прием заявок 24 часа",
        specialistArrival: "Специалист будет у вас в течение 30 минут!",
        professionalEquipment: "Работаем только с профессиональным оборудованием",
        warranty: "Гарантия до 24 месяцев!",
        orderCleaning: "Заказать уборку",
        fast: "Быстро",
        fastDescription: "Специалист будет у вас в течение 30 минут!",
        quality: "Качественно",
        qualityDescription: "Работаем только с профессиональным оборудованием.",
        guarantee: "Гарантия",
        guaranteeDescription: "Гарантия до 24 месяцев!",
        cleaning: "Уборка помещений",
        cleaningDescription: "Комплексная уборка офисов, квартир и других помещений с использованием профессионального оборудования.",
        furnitureCleaning: "Химчистка мебели и ковров",
        furnitureCleaningDescription: "Глубокая очистка мебели и ковров от загрязнений и аллергенов с использованием безопасных средств.",
        postRenovation: "Уборка после ремонта",
        postRenovationDescription: "Полная уборка после строительных работ, включая удаление пыли, грязи и строительного мусора.",
        details: "Подробнее",
        commonProblems: "Популярные проблемы",
        commonProblemsDesc: "В процессе химчистки и дезинфекции часто возникают такие проблемы, как устойчивые пятна, которые сложно удалить, аллергены и микробы в труднодоступных местах. Наша компания использует профессиональное оборудование и средства, позволяющие эффективно справляться с этими задачами.",
        ourAdvantages: "Преимущества нашего сервиса",
        ourAdvantagesDesc: "Мы гарантируем высокое качество обслуживания, быстрый выезд специалиста и использование профессионального оборудования. Наши услуги не только устраняют видимые проблемы, но и способствуют уничтожению микробов, обеспечивая здоровую атмосферу в вашем помещении. Кроме того, мы предлагаем гарантию на все виды работ.",
        howItWorks: "Как проходит химчистка и дезинфекция",
        howItWorksDesc: "Процесс начинается с диагностики и определения типа загрязнения. Далее, в зависимости от задачи, выбирается метод и средства для химчистки или дезинфекции. Наши мастера тщательно обрабатывают каждый участок, обеспечивая глубокое очищение и дезинфекцию. По завершении работы проводится финальная проверка качества.",
        pricing: "Стоимость химчистки и дезинфекции",
        pricingDesc: "Цена на химчистку и дезинфекцию зависит от нескольких факторов: размера и типа обрабатываемой поверхности, степени загрязнения, а также необходимости использования специализированных средств. Мы предлагаем конкурентоспособные цены и готовы предоставить точную стоимость после осмотра объекта.",
        howToOrder: "Как можно вызвать специалиста",
        howToOrderDesc: "Заказать выезд специалиста можно, позвонив по телефону: +7 (978) 512-03-92, или оставив заявку в онлайн-форме на нашем сайте. Мы гарантируем быстрый отклик и готовы оперативно приступить к решению вашей проблемы.",
        finalNote: "Выбирая нас, вы выбираете надежность, качество и профессионализм. Обращайтесь, и ваш дом или офис будет сиять чистотой и свежестью!",
        address: "Адрес: Республика Крым, г. Феодосия, Симферопольское ш., д. 26",
        phone: "Телефон: +7 (978) 512-03-92",
        email: "Email: nikituxa111@gmail.com",
        rights: "Все права защищены",
        addReview: "Добавить отзыв"
    },
    en: {
        title: "Dry Cleaning and Disinfection in Feodosia",
        about: "About Us",
        services: "Services",
        reviews: "Reviews",
        contacts: "Contacts",
        welcomeTitle: "Dry Cleaning and Disinfection in Feodosia",
        welcomeText: "Emergency call to home, office, apartment:",
        freeConsultation: "Free consultation",
        acceptRequests: "24/7 service",
        specialistArrival: "Specialist will arrive within 30 minutes!",
        professionalEquipment: "We use professional equipment",
        warranty: "24 months warranty!",
        orderCleaning: "Order Cleaning",
        fast: "Fast",
        fastDescription: "Specialist will arrive within 30 minutes!",
        quality: "Quality",
        qualityDescription: "We use professional equipment.",
        guarantee: "Warranty",
        guaranteeDescription: "24 months warranty!",
        cleaning: "Premises Cleaning",
        cleaningDescription: "Comprehensive cleaning of offices, apartments, and other premises using professional equipment.",
        furnitureCleaning: "Furniture and Carpet Cleaning",
        furnitureCleaningDescription: "Deep cleaning of furniture and carpets from dirt and allergens using safe products.",
        postRenovation: "Post-Renovation Cleaning",
        postRenovationDescription: "Complete cleaning after construction work, including removal of dust, dirt, and construction debris.",
        details: "Details",
        commonProblems: "Common Problems",
        commonProblemsDesc: "During dry cleaning and disinfection, common issues such as stubborn stains, allergens, and microbes in hard-to-reach areas often arise. Our company uses professional equipment and products to effectively address these challenges.",
        ourAdvantages: "Our Advantages",
        ourAdvantagesDesc: "We guarantee high-quality service, quick specialist arrival, and the use of professional equipment. Our services not only eliminate visible issues but also help destroy microbes, ensuring a healthy environment in your space. Additionally, we offer a warranty on all types of work.",
        howItWorks: "How It Works",
        howItWorksDesc: "The process begins with diagnostics and determining the type of contamination. Depending on the task, the method and products for dry cleaning or disinfection are selected. Our specialists meticulously treat each area, ensuring deep cleaning and disinfection. A final quality check is performed upon completion.",
        pricing: "Pricing",
        pricingDesc: "The cost of dry cleaning and disinfection depends on several factors: the size and type of the surface being treated, the degree of contamination, and the need for specialized products. We offer competitive prices and can provide an exact quote after inspecting the object.",
        howToOrder: "How to Order",
        howToOrderDesc: "To order a specialist visit, call +7 (978) 512-03-92 or submit a request through our website. We guarantee a quick response and are ready to promptly address your issue.",
        finalNote: "By choosing us, you choose reliability, quality, and professionalism. Contact us, and your home or office will shine with cleanliness and freshness!",
        address: "Address: Republic of Crimea, Feodosia, Simferopolskoye sh., 26",
        phone: "Phone: +7 (978) 512-03-92",
        email: "Email: nikituxa111@gmail.com",
        rights: "All rights reserved",
        addReview: "Add Review"
    }
};
let currentLanguage = 'ru';
let currentReviewIndex = 0;
const reviewsPerPage = 3;
const isAdmin = false; // Установите false для обычного пользователя
function changeLanguage(lang) {
    currentLanguage = lang;
    document.querySelectorAll('[data-key]').forEach(element => {
        const key = element.getAttribute('data-key');
        if (translations[lang][key]) {
            element.textContent = translations[lang][key];
        }
    });
    localStorage.setItem('language', lang);
}

document.getElementById('language-toggle').addEventListener('click', () => {
    const newLang = currentLanguage === 'ru' ? 'en' : 'ru';
    changeLanguage(newLang);
    document.getElementById('language-toggle').textContent = newLang === 'ru' ? 'EN' : 'RU';
});

window.onload = () => {
    const savedLang = localStorage.getItem('language') || 'ru';
    changeLanguage(savedLang);
    document.getElementById('language-toggle').textContent = savedLang === 'ru' ? 'EN' : 'RU';
};
// Функция для добавления отзыва
function addReview() {
    const name = document.getElementById('review-name').value;
    const phone = document.getElementById('review-phone').value;
    const text = document.getElementById('review-text').value;
    const rating = document.querySelector('input[name="fst"]:checked').value;

    if (name && phone && text && rating) {
        if (!/^\d{11}$/.test(phone)) {
            alert('Номер телефона должен состоять из 11 цифр.');
            return;
        }

        // Сохранение отзыва в localStorage
        const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
        reviews.unshift({ name, text, rating }); // Добавляем новый отзыв в начало массива
        localStorage.setItem('reviews', JSON.stringify(reviews));

        // Очистка полей
        document.getElementById('review-name').value = '';
        document.getElementById('review-phone').value = '';
        document.getElementById('review-text').value = '';

        // Отображение отзывов
        showReviews();
    } else {
        alert('Пожалуйста, заполните все поля и выберите рейтинг.');
    }
}

// Функция для удаления отзыва
function deleteReview(button) {
    const reviewItem = button.parentElement;
    const reviewList = document.getElementById('review-list');
    reviewList.removeChild(reviewItem);

    // Удаление отзыва из localStorage
    const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
    const name = reviewItem.querySelector('h4').textContent;
    const text = reviewItem.querySelector('p').textContent;
    const updatedReviews = reviews.filter(review => review.name !== name || review.text !== text);
    localStorage.setItem('reviews', JSON.stringify(updatedReviews));

    // Отображение обновленного списка отзывов
    showReviews();
}

// Функция для отображения отзывов
function showReviews() {
    const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
    const reviewList = document.getElementById('review-list');
    reviewList.innerHTML = '';

    // Отображаем только 3 отзыва
    const startIndex = currentReviewIndex;
    const endIndex = startIndex + reviewsPerPage;
    const visibleReviews = reviews.slice(startIndex, endIndex);

    visibleReviews.forEach((review, index) => {
        const reviewItem = document.createElement('div');
        reviewItem.className = 'review-item';
        reviewItem.innerHTML = `
            <h4>${review.name}</h4>
            <p>${review.text}</p>
            <div class="rating">
                ${Array.from({ length: 5 }, (_, i) => `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="${i < review.rating ? 'filled' : ''}">
                        <path d="M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/>
                    </svg>
                `).join('')}
            </div>
            ${isAdmin ? '<button onclick="deleteReview(this)">Удалить</button>' : ''}
        `;
        reviewList.appendChild(reviewItem);
    });
}

// Функция для перелистывания вперед
function nextReview() {
    const reviews = JSON.parse(localStorage.getItem('reviews')) || [];
    if (currentReviewIndex + reviewsPerPage < reviews.length) {
        currentReviewIndex++;
        showReviews();
    }
}

// Функция для перелистывания назад
function prevReview() {
    if (currentReviewIndex > 0) {
        currentReviewIndex--;
        showReviews();
    }
}

// Загрузка отзывов при загрузке страницы
window.onload = function () {
    showReviews();
};

// Плавный переход к разделам
document.querySelectorAll('nav a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
            const offset = 150; // Увеличенный отступ от верха
            const elementPosition = targetElement.getBoundingClientRect().top;
            const offsetPosition = elementPosition + window.pageYOffset - offset;

            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
    });
});

// Прокрутка вверх при нажатии на логотип
document.querySelector('.logo-link').addEventListener('click', function (e) {
    e.preventDefault();
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
});

ymaps.ready(init);

function init() {
    const map = new ymaps.Map("map", {
        center: [45.048, 35.379], // Координаты Феодосии
        zoom: 12,
        controls: [] // Убираем лишние элементы управления
    });

    const searchControl = new ymaps.control.SearchControl({
        options: {
            provider: 'yandex#search',
            noPlacemark: true // Не показывать метку на карте
        }
    });

    map.controls.add(searchControl);

    // Обработка выбора адреса
    searchControl.events.add('resultselect', function (e) {
        const selectedAddress = searchControl.getResultsArray()[e.get('index')].properties.get('name');
        document.getElementById('address').value = selectedAddress;
    });
}